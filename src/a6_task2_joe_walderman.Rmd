---
title: "Is there a relationship between political affiliation and environmentalism?"
author: "Joe Walderman"
date: "12/3/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
library(tidyverse)
library(here)
library(janitor)
library(broom)
library(kableExtra)
```

## Intro and Data

This dataset is from an online survey of 1,331 Americans accross the country collected in 2017 covering a variety of topics. This report utilizes two of these topics, one sayiing "I considering myself an environmentalist" and providing response options, the other asking "how do you self-identify politically?". A Chi-Square test is utilized to assess if there is an association between political affiliation and if a person considers theself an environmentalist.

## Reading in and cleaning data

```{r}
survey <- read.csv(here("data", "conservation_survey.csv"))

survey_clean <- survey %>% 
  clean_names()
```

## Making a subset and mutating

```{r}
survey_env <- survey_clean %>% 
  select(env_id, pol_or) %>%
  mutate(affiliation = case_when(
    pol_or %in% c(1, 2, 3) ~ "Conservative",
    pol_or %in% c(5, 6, 7) ~ "Liberal",
  )) %>% 
  mutate(enviro = case_when(
    env_id == 1 ~ "Yes",
    env_id == 2 ~ "No",
    env_id == 3 ~ "Unsure"
  )) %>% 
  drop_na() # excluding observations with NA affiliation values
```


## Find counts and proportions of liberal and conservative identifying survey responders responding no, unsure, or yes to a question about whether they consinder themselves an environmentalist 

```{r, include=FALSE}
survey_env %>% 
  count(affiliation, enviro)
```

```{r}
survey_counts <- survey_env %>% 
  tabyl(affiliation, enviro)

survey_proportions <- survey_counts %>% 
  adorn_percentages() %>% # showing percentage of people surveyed from each party responding no, unsure, or yes to environmentalist question
  adorn_pct_formatting(digits = 2) %>% # rounding decimals
  adorn_ns() %>% # actual counts in each cell as well in parenthesis
  select(1,4,2,3) #reordering columns

survey_proportions %>% 
  kable(col.names = c("", "Yes", "No", "Unsure")) %>% 
  kable_styling(bootstrap_options = "striped", full_width = FALSE)
```

## Contingency table

```{r}
survey_ct <- survey_counts %>% 
  column_to_rownames(var = "affiliation") %>% # pulling column information into rownames so now I just have two columns and ready to be fed into chi sqrd
  select(Yes, No, Unsure ) # Reordering columns
```

## Chi-square test: is there an association between political affiliation and if a person considers themself an environmentalist? In other words, are political affiliation and identification as an environemntalist independent?

```{r}
survey_x2 <- chisq.test(survey_ct)
survey_tidy <- tidy(survey_x2)
```

### There is a significant association between political affiliation and identification as an environmentalist  ($\chi$^2^(`r survey_tidy$parameter`) = `r round(survey_tidy$statistic,2)`, *p* = `r round(survey_tidy$p.value,3)`).

